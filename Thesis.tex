% Template by Koungmeng
\documentclass[12pt,a4paper]{report}

\usepackage{fontspec}
\usepackage{polyglossia}
\usepackage{tikz}
\usepackage{fancyhdr}
\usepackage{ragged2e}
\usepackage{tocloft}
\usepackage{hyperref}
\usepackage{titlesec}
\usepackage{textcase}
\usepackage{tabularx}
\usepackage{caption}
\usepackage[round,sort&compress]{natbib}
\usepackage[top=1in,right=1in,bottom=1in,left=1.25in]{geometry}
\usepackage{graphicx}
\usepackage{setspace}
\usepackage{chngcntr}

% List of tables format
\setlength{\cftbeforelottitleskip}{0.75\baselineskip}
\setlength{\cftafterlottitleskip}{1.75\baselineskip}
\renewcommand{\listtablename}{LIST OF TABLES}
\renewcommand{\cftlottitlefont}{\hfill\normalfont\bfseries\normalsize\MakeUppercase} 
\renewcommand{\cftafterlottitle}{\hfill\vspace{0\baselineskip}} 
\renewcommand{\cfttabindent}{0em}
\renewcommand{\cfttabpresnum}{Table }
\renewcommand{\cfttabaftersnum}{\space} 
\renewcommand{\cfttabnumwidth}{4.75em}

% List of Figures format
\setlength{\cftbeforeloftitleskip}{0.75\baselineskip}
\setlength{\cftafterloftitleskip}{1.75\baselineskip}
\renewcommand{\listfigurename}{LIST OF FIGURES}
\renewcommand{\cftloftitlefont}{\hfill\normalfont\bfseries\normalsize\MakeUppercase}
\renewcommand{\cftafterloftitle}{\hfill\vspace{0\baselineskip}}
\renewcommand{\cftfigindent}{0em}
\renewcommand{\cftfigpresnum}{Figure }
\renewcommand{\cftfigaftersnum}{\space}
\renewcommand{\cftfignumwidth}{4.25em}
\newcommand*{\noaddvspace}{\renewcommand*{\addvspace}[1]{}}
\addtocontents{lof}{\protect\noaddvspace}

% Table of Contents format
\makeatletter
\renewcommand{\@cftmaketoctitle}{}
\makeatother
\titleformat{\chapter}[display]
    {\normalfont\fontsize{12}{12.8}\bfseries\centering}
    {\MakeUppercase{\chaptertitlename\ \thechapter}}
    {0\baselineskip}
    {\MakeUppercase} 
\titlespacing*{\chapter}
    {0pt}
    {12pt}
    {12pt}

\titleformat{\section}[block] 
    {\normalfont\fontsize{12}{12.8}\bfseries}
    {\thesection} 
    {0.5em}
    {} 
\titlespacing*{\section}
    {0pt} 
    {0pt}
    {0pt} 

\titleformat{\subsection}[block]
    {\normalfont\fontsize{12}{12.8}\bfseries} 
    {\thesubsection} 
    {0.5em} 
    {} 
\titlespacing*{\subsection}
    {0pt} 
    {0pt}
    {0pt} 

\setlength{\cftchapindent}{0em}
\setlength{\cftsecindent}{2em}
\setlength{\cftsubsecindent}{4em}
\renewcommand{\cftchappresnum}{CHAPTER }
\renewcommand{\cftchapaftersnum}{\hspace{0em}}
\setlength{\cftchapnumwidth}{5.6em} 
\makeatletter
\newcommand{\l@others}[2]{%
  \noindent #1\nobreak\leaders\hbox{\hspace{0.25em}.\hspace{0.25em}}\hfill\nobreak #2
  \par
}
\makeatother

\makeatletter
\newcommand{\l@end}[2]{%
  \vspace{1em}
  \noindent #1\nobreak\leaders\hbox{\hspace{0.25em}.\hspace{0.25em}}\hfill\nobreak #2
  \par
}
\makeatother

\renewcommand{\cftchapfont}{\normalsize\normalfont}
\renewcommand{\cftchappagefont}{\normalsize\normalfont}
\renewcommand{\cftdotsep}{4.5}


% Caption customization
\renewcommand{\tablename}{Table}
\usepackage[labelfont=bf, font=bf]{caption}
\captionsetup[table]{justification=raggedright,singlelinecheck=false}
\renewcommand{\figurename}{Figure}
\captionsetup[figure]{labelsep=space}
\captionsetup[table]{labelsep=space}
\renewcommand{\arraystretch}{1.5}
\counterwithout{figure}{chapter}

% Working with languages and fonts
\XeTeXlinebreaklocale "khm"
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt
\XeTeXlinebreakpenalty = 0

\newcommand{\khmerpar}[1]{%
    \par
    \khmerfont
    \justifying
    \begin{spacing}{1.75}%
        \XeTeXlinebreaklocale "khm"
        #1%
    \end{spacing}%
}
\setmainlanguage{english}
\setotherlanguage{khmer}
\SetLanguageKeys{english}{indentfirst=true}

\setmainfont{Times New Roman}
\newfontfamily\khmerfont[Script=Khmer]{Khmer OS Siemreap}
\newfontfamily\khmermuol[Script=Khmer]{Khmer OS Muol Light}
\newcommand{\kh}[1]{{\khmerfont #1}}
\newcommand{\khm}[1]{{\khmermuol #1}}

% Configure metadata
\hypersetup{
    pdftitle={Thesis Report},
    pdfauthor={EONG KOUNGMENG},
    pdfsubject={Subject of the Document},
    pdfkeywords={keyword1, keyword2, keyword3},
    colorlinks=true, 
    linkcolor=black,   
    urlcolor=blue,    
    citecolor=black   
}

% Page footer numbering
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[R]{\thepage}
\fancypagestyle{plain}{%
    \renewcommand{\headrulewidth}{0pt}%
    \fancyhf{}%
    \fancyfoot[R]{\thepage}%
}
\renewcommand{\headrulewidth}{0pt}

% Start document
\begin{document}

\begin{titlepage}
    \begin{tikzpicture}[remember picture, overlay]
        \node[anchor=north] at ([xshift=1.25in,yshift=-0.85in]current page.north west) {
            \includegraphics[width=1.17in, height=1.16in]{figures/RUPP.jpg}
        };

        \node[anchor=north, inner sep=0pt] at ([xshift=0.10in, yshift=-1in]current page.north) {
            \begin{minipage}[t][\textheight][t]{\textwidth}
                \centering
                {\fontsize{16}{16.8}\khm{សាកលវិទ្យាល័យភូមិន្ទភ្នំពេញ}\par}
                \vspace{0.4cm}
                {\textbf{ROYAL UNIVERSITY OF PHNOM PENH}\par}
                \vspace{\stretch{1}}
                {\fontsize{14}{14.8}\khm{ប្រធានបទនិក្ខេបបទ}\par}
                \vspace{0.4cm}
                {\fontsize{14}{14.8}\textbf{A novel approach to Khmer Handwritten Text Recognition using Fine-tuned TrOCR}\par}
                \vspace{\stretch{1}}
                {
                    \setstretch{1.2}
                    \fontsize{13}{13.8}\selectfont
                    A Thesis \par
                    In Partial Fulfilment of the Requirement for the Degree of \par
                    Bachelor of Engineering in Information-Technology-Engineering \par
                }
                \vspace{\stretch{1}}
                {\fontsize{14}{14.8}\textbf{Author Name}\par}
                \vspace{\stretch{2}}
                {\fontsize{20}{20.8}\textbf{June 2025}\par}
            \end{minipage}
        };
    \end{tikzpicture}
\end{titlepage}

\begin{titlepage}
    \begin{tikzpicture}[remember picture, overlay]

        \node[anchor=north, inner sep=0pt] at ([xshift=0.10in, yshift=-1in]current page.north) {
            \begin{minipage}[t][\textheight][t]{\textwidth}
                \centering
                {\fontsize{16}{16.8}\khm{សាកលវិទ្យាល័យភូមិន្ទភ្នំពេញ}\par}
                \vspace{0.4cm}
                {\textbf{ROYAL UNIVERSITY OF PHNOM PENH}\par}
                \vspace{\stretch{1}}
                {\fontsize{14}{14.8}\khm{ប្រធានបទនិក្ខេបបទ}\par}
                \vspace{0.4cm}
                {\fontsize{14}{14.8}\textbf{Title in English}\par}
                \vspace{\stretch{1}}
                {
                    \setstretch{1.2}
                    \fontsize{13}{13.8}\selectfont
                    A Thesis \par
                    In Partial Fulfilment of the Requirement for the Degree of \par
                    Bachelor of Engineering in Information-Technology-Engineering \par
                }
                \vspace{\stretch{1}}
                {\fontsize{14}{14.8}\textbf{Author Name}\par}
                \vspace{\stretch{1}}
                \begin{tabular}{ll}
                    Examination committee: & Mr. PHAL DES (Chairperson)     \\
                                           & Dr. .......................... \\
                                           & Dr. .......................... \\
                \end{tabular}

                \vspace{\stretch{1}}
                {\fontsize{20}{20.8}\textbf{June 2025}\par}
            \end{minipage}
        };
    \end{tikzpicture}
\end{titlepage}

\newpage
\phantomsection
\addcontentsline{toc}{others}{Abstract in Khmer}
\pagenumbering{roman}
\vspace*{0\baselineskip}
\begin{center}
    \fontsize{12}{12.8}\khm{មូលន័យសង្ខេប}
\end{center}
\vspace*{1.5\baselineskip}
\begin{minipage}{\textwidth}
    \khmerpar{
        [ព័ត៌មានលម្អិតនៃមូលន័យសង្ខេប]
    }
\end{minipage}


\newpage
\phantomsection
\addcontentsline{toc}{others}{Abstract in English}
\vspace*{0\baselineskip}
\begin{center}
    \textbf{ABSTRACT}
\end{center}
\vspace*{1.5\baselineskip}
\begin{spacing}{1.5}
    [Abstract detail]
\end{spacing}

\newpage
\phantomsection
\addcontentsline{toc}{others}{Supervisor's research supervision statement}
\vspace*{0\baselineskip}
\begin{center}
    \textbf{SUPERVISOR'S RESEARCH SUPERVISION STATEMENT}
\end{center}
\vspace*{1.5\baselineskip}
\noindent
TO WHOM IT MAY CONCERN

\vspace*{2\baselineskip}

\noindent
\begin{minipage}{\textwidth}
    \noindent
    Name of program: {\dotfill} \par
    \noindent
    Name of candidate: {\dotfill} \par
    \vspace*{2\baselineskip}
    Title of research report:{\dotfill} \par
    \vspace*{2\baselineskip}
    This is to certify that the research carried out for the above titled Bachelor's research report was completed by the above-named candidate under my direct supervision. This thesis material has not been used for any other degree. I played the following part in the preparation of this research report:{\dotfill} \par
    \vspace*{2\baselineskip}
    Supervisor's Name: {\dotfill} \par
    \vspace*{1\baselineskip}
    Supervisor's signature: {\dotfill} \par
    \vspace*{1\baselineskip}
    Date: {\dotfill} \par
\end{minipage}


\newpage
\phantomsection
\addcontentsline{toc}{others}{Candidate's Statement}
\vspace*{0\baselineskip}
\begin{center}
    \textbf{CANDIDATE'S STATEMENT}
\end{center}
\vspace*{1.5\baselineskip}
\noindent
TO WHOM IT MAY CONCERN

\vspace*{2\baselineskip}

\noindent
\begin{minipage}{\textwidth}
    \noindent
    This is to certify that the research report that I (Koungmeng) hereby present entitled project title. \par
    \noindent

    \vspace*{2\baselineskip}
    for the degree of Bachelor of Engineering at the Royal University of Phnom Penh is entirely my own work and, furthermore, that it has not been used to fulfill the requirements of any other qualification in whole or in part, at this or any other University or equivalent institution. \par
    \vspace*{1\baselineskip}
    No reference to, or quotation from, this document may be made without the written approval of the author.\par
    \vspace*{2\baselineskip}
    Signed by (the candidate): {\dotfill} \par
    \vspace*{1\baselineskip}
    Date: {\dotfill} \par
    \vspace*{2\baselineskip}
    Signed by Supervisor: {\dotfill} \par
    \vspace*{1\baselineskip}
    Supervisor's signature: {\dotfill} \par
    \vspace*{1\baselineskip}
    Date: {\dotfill} \par
\end{minipage}

\newpage
\phantomsection
\addcontentsline{toc}{others}{Acknowledgements}
\vspace*{0\baselineskip}
\begin{center}
    \textbf{ACKNOWLEDGEMENTS}
\end{center}
\vspace*{1.5\baselineskip}
\begin{spacing}{1.5}
    [Acknowledgement detail]
\end{spacing}

\newpage
\phantomsection
\addcontentsline{toc}{others}{Table of Contents}
\vspace*{0\baselineskip}
\begin{center}
    \textbf{TABLE OF CONTENTS}
\end{center}
\vspace*{0.75\baselineskip}
\tableofcontents

\newpage
\phantomsection
\addcontentsline{toc}{others}{List of Tables}
\listoftables

\newpage
\phantomsection
\addcontentsline{toc}{others}{List of Figures}
\listoffigures

\setlength{\parindent}{0.5in}  % First line indent for each paragraph
\setlength{\parskip}{6pt}      % Space between paragraphs
\setstretch{1.5}               % Line spacing within paragraphs
\newpage

\setcounter{page}{1}
\pagenumbering{arabic}
\include{chapters/chapter1}
\include{chapters/chapter2}

\newpage
\phantomsection
\addcontentsline{toc}{end}{REFERENCES}
\vspace{1em}
\begin{center}
    \textbf{REFERENCES}
\end{center}
\makeatletter
\renewcommand\@biblabel[1]{[#1]}%
\renewenvironment{thebibliography}[1]{%
    \list{\@biblabel{\arabic{enumiv}}}{%
        \usecounter{enumiv}%
        \setlength{\labelwidth}{0pt}%
        \setlength{\leftmargin}{\parindent}%
        \setlength{\itemindent}{-\parindent}%
        \setlength{\itemsep}{0pt}%
        \setlength{\parsep}{\z@}%
    }%
    \sloppy
}{%
    \def\@noitemerr{\@latex@warning{Empty `thebibliography' environment}}%
    \endlist
}
\makeatother
\bibliographystyle{CSE-modified}
\nocite{*}
\bibliography{references}

\newpage
\phantomsection
\addcontentsline{toc}{end}{APPENDICES}
\vspace{1em}
\begin{center}
    \textbf{APPENDICES}
\end{center}
[Appendix detail]
\end{document}
